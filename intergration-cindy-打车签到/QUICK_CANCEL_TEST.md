# 🚀 快速测试取消功能

## 📋 测试前准备

### 1. 确保服务运行中

```bash
# 后端应该在运行（端口 3001）
# 前端应该在运行（端口 3002）
```

### 2. 刷新浏览器

```
按 Command/Ctrl + Shift + R 强制刷新
```

---

## 🧪 测试场景 1: 查看行程详情

### 步骤：

1. **访问** http://localhost:3002
2. **登录** demo@cornell.edu / demo1234
3. **点击** Carpooling 标签
4. **点击** My Trips 标签
5. **点击** 任意一个行程卡片

### ✅ 预期结果：

- 弹出行程详情弹窗
- 显示完整的行程信息
- 看到角色徽章（Driver 或 Passenger）
- 如果行程未开始，显示取消按钮

---

## 🧪 测试场景 2: 乘客取消预订

### 步骤：

1. **登录** demo@cornell.edu / demo1234
2. **进入** Carpooling → My Trips
3. **找到** 状态为 "Pending" 或 "Confirmed" 的预订
4. **点击** 该行程卡片
5. **确认** 显示 "Cancel My Booking" 按钮
6. **点击** 取消按钮
7. **等待** 处理完成

### ✅ 预期结果：

- 显示 "Booking Cancelled" 成功消息
- 弹窗自动关闭
- My Trips 列表自动刷新
- 该预订状态变为 "Cancelled"

---

## 🧪 测试场景 3: 司机取消单个预订

### 步骤：

1. **登录** alice@cornell.edu / alice1234
2. **进入** Carpooling → My Trips
3. **点击** 有乘客预订的行程
4. **查看** "Passengers" 列表
5. **点击** 某个乘客旁边的 "Cancel Booking" 按钮
6. **等待** 处理完成

### ✅ 预期结果：

- 显示成功消息（如 "Demo User's booking has been cancelled"）
- 列表自动刷新
- 该乘客的预订状态更新
- 座位数自动调整

---

## 🧪 测试场景 4: 司机取消整趟行程

### 步骤：

1. **登录** alice@cornell.edu / alice1234
2. **进入** Carpooling → My Trips
3. **点击** 任意行程卡片
4. **滚动** 到底部
5. **点击** "Cancel This Trip" 按钮
6. **等待** 处理完成

### ✅ 预期结果：

- 显示 "Trip Cancelled" 成功消息
- 弹窗自动关闭
- 该行程从 My Trips 列表中消失或状态变为 "Cancelled"
- 所有乘客收到通知

---

## 🧪 测试场景 5: 行程开始后无法取消

### 步骤：

1. **登录** 任意账户
2. **进入** Carpooling → My Trips
3. **点击** 一个过去时间的行程（如果有）
4. **查看** 详情弹窗

### ✅ 预期结果：

- 不显示取消按钮
- 显示提示消息：
  ```
  🚗 Trip has started. 
  Cancellation is no longer available.
  ```

---

## 📱 UI 检查清单

### My Trips 列表页面

- [ ] 行程卡片可以点击
- [ ] 鼠标悬停时有阴影效果
- [ ] 显示角色徽章（Driver/Passenger）
- [ ] 显示状态标签

### 详情弹窗（Passenger 视图）

- [ ] 标题显示 "My Trip (Passenger)"
- [ ] 显示 "🎒 You are a Passenger"
- [ ] 显示完整行程信息
- [ ] 显示司机信息
- [ ] 显示取消按钮（如果可以取消）
- [ ] 按钮文字 "Cancel My Booking"

### 详情弹窗（Driver 视图）

- [ ] 标题显示 "My Trip (Driver)"
- [ ] 显示 "🚗 You are the Driver"
- [ ] 显示完整行程信息
- [ ] 显示乘客列表（如果有）
- [ ] 每个乘客旁边有 "Cancel Booking" 按钮
- [ ] 底部显示 "Cancel This Trip" 按钮

---

## 🐛 常见问题

### Q1: 点击卡片没有反应？

**解决方案：**
```bash
# 强制刷新浏览器
Command/Ctrl + Shift + R
```

### Q2: 取消按钮是灰色的？

**原因：**
- 行程已经开始
- 预订状态不是 pending/confirmed

### Q3: 点击取消后报错？

**检查：**
1. 后端是否运行在端口 3001
2. 打开浏览器控制台查看具体错误
3. 查看后端终端输出

---

## 🎯 快速验证（1分钟）

### 最简测试流程：

```bash
1. 刷新浏览器 ✓
2. 登录 demo@cornell.edu ✓
3. Carpooling → My Trips ✓
4. 点击任意行程 ✓
5. 查看详情弹窗 ✓
6. 如果显示取消按钮，点击测试 ✓
```

---

## 📊 测试结果记录

| 测试场景 | 状态 | 备注 |
|---------|------|------|
| 查看行程详情 | ⬜ |  |
| 乘客取消预订 | ⬜ |  |
| 司机取消单个预订 | ⬜ |  |
| 司机取消整趟行程 | ⬜ |  |
| 行程开始后禁止取消 | ⬜ |  |

---

## 🎉 测试完成后

如果所有功能正常，你应该看到：

- ✅ 可以点击行程卡片查看详情
- ✅ 取消按钮根据条件正确显示/隐藏
- ✅ 取消功能正常工作
- ✅ 自动发送通知
- ✅ 座位数自动更新
- ✅ 状态自动更新

---

**祝测试顺利！🚀**




